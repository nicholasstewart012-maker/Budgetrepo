[{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\constants\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\context\\AppContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RoleService' is defined but never used.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":21},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":31,"column":33,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":31,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\r\nimport { WebPartContext } from '@microsoft/sp-webpart-base';\r\nimport { IUser } from '../models/IUser';\r\nimport { SharePointService } from '../services/SharePointService';\r\nimport { GraphService } from '../services/GraphService';\r\nimport { RoleService } from '../services/RoleService';\r\n\r\nexport type ViewType = 'User' | 'Manager' | 'OrgDev' | 'Accounting';\r\n\r\nexport interface IAppContext {\r\n    context: WebPartContext;\r\n    currentUser: IUser;\r\n    spService: SharePointService;\r\n    graphService: GraphService;\r\n    roles: {\r\n        isManager: boolean;\r\n        isOrgDev: boolean;\r\n        isAccounting: boolean;\r\n    };\r\n    navigation: {\r\n        currentView: ViewType;\r\n        setCurrentView: (view: ViewType) => void;\r\n    };\r\n    lists: {\r\n        requestsList: string;\r\n    };\r\n}\r\n\r\nexport const AppContext = React.createContext<IAppContext | undefined>(undefined);\r\n\r\nexport const useAppContext = () => {\r\n    const context = React.useContext(AppContext);\r\n    if (!context) {\r\n        throw new Error('useAppContext must be used within an AppProvider');\r\n    }\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\hooks\\useCurrentUser.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\hooks\\useManagerCheck.ts","messages":[{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":5,"column":61,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":5,"endColumn":63},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":13,"column":41,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":13,"endColumn":43},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":31,"column":9,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":31,"endColumn":26,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[1092,1092],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[1092,1092],"text":"await "},"desc":"Add await operator."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { GraphService } from '../services/GraphService';\r\nimport { IUser } from '../models/IUser';\r\n\r\nexport const useManagerCheck = (graphService: GraphService) => {\r\n    const [manager, setManager] = useState<IUser | null>(null);\r\n    const [directReports, setDirectReports] = useState<IUser[]>([]);\r\n    const [loading, setLoading] = useState<boolean>(true);\r\n\r\n    useEffect(() => {\r\n        let isMounted = true;\r\n\r\n        const fetchGraphData = async () => {\r\n            try {\r\n                const [mgr, reports] = await Promise.all([\r\n                    graphService.getMyManager(),\r\n                    graphService.getMyDirectReports()\r\n                ]);\r\n\r\n                if (isMounted) {\r\n                    setManager(mgr);\r\n                    setDirectReports(reports);\r\n                    setLoading(false);\r\n                }\r\n            } catch (error) {\r\n                console.error('Error fetching manager/reports:', error);\r\n                if (isMounted) setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchGraphData();\r\n\r\n        return () => {\r\n            isMounted = false;\r\n        };\r\n    }, [graphService]);\r\n\r\n    return { manager, directReports, hasDirectReports: directReports.length > 0, loading };\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\hooks\\useRoleAccess.ts","messages":[{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":4,"column":98,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":4,"endColumn":100}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useMemo } from 'react';\r\nimport { RoleService } from '../services/RoleService';\r\n\r\nexport const useRoleAccess = (userEmail: string, orgDevEmails: string, accountingEmails: string) => {\r\n    const isOrgDev = useMemo(() => RoleService.isUserInRole(userEmail, orgDevEmails), [userEmail, orgDevEmails]);\r\n    const isAccounting = useMemo(() => RoleService.isUserInRole(userEmail, accountingEmails), [userEmail, accountingEmails]);\r\n\r\n    return { isOrgDev, isAccounting };\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\models\\IConferenceRequest.ts","messages":[{"ruleId":"@rushstack/no-new-null","severity":1,"message":"Usage of \"null\" is deprecated except when describing legacy APIs; use \"undefined\" instead","line":12,"column":30,"nodeType":"TSNullKeyword","messageId":"error-new-usage-of-null","endLine":12,"endColumn":34},{"ruleId":"@rushstack/no-new-null","severity":1,"message":"Usage of \"null\" is deprecated except when describing legacy APIs; use \"undefined\" instead","line":13,"column":28,"nodeType":"TSNullKeyword","messageId":"error-new-usage-of-null","endLine":13,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export type RequestStatus =\r\n    | 'Pending Manager Approval'\r\n    | 'Pending Org Dev Approval'\r\n    | 'Pending Accounting Approval'\r\n    | 'Fully Approved'\r\n    | 'Denied'\r\n    | 'Draft';\r\n\r\nexport interface IConferenceRequest {\r\n    Id?: number; // SharePoint List ID\r\n    Title: string; // Auto-set to Event Name\r\n    EventStartDate: string | null; // ISO string\r\n    EventEndDate: string | null; // ISO string\r\n    EventName: string;\r\n    EventLocation: string;\r\n    Attendees: string; // JSON array of names/emails\r\n    PrimaryObjective: string;\r\n    CorporatePriorities: string; // JSON array of selected priorities\r\n    KnowledgeSharingPlan: string;\r\n    PreviouslyAttended?: string; // Optional\r\n    HowManyAttended: number; // From handwritten note\r\n\r\n    // Costs\r\n    RegistrationCost: number;\r\n    AirfareCost: number;\r\n    LodgingCost: number;\r\n    MeetingRoomRentalCost: number;\r\n    CarRentalCost: number;\r\n    TravelMealAllowanceCost: number;\r\n    ConferenceMealsCost: number;\r\n    OtherCost: number;\r\n    TotalEstimatedBudget: number; // Auto-calculated\r\n\r\n    AdditionalComments?: string;\r\n    AttachmentURL?: string; // Link to uploaded document\r\n    Status: RequestStatus;\r\n\r\n    // Workflow\r\n    SubmitterEmail: string;\r\n    SubmitterName: string;\r\n    ManagerEmail?: string;\r\n    ManagerApprovalDate?: string;\r\n    ManagerDenialReason?: string;\r\n    OrgDevApproverEmail?: string;\r\n    OrgDevApprovalDate?: string;\r\n    OrgDevDenialReason?: string;\r\n    AccountingApproverEmail?: string;\r\n    AccountingApprovalDate?: string;\r\n    AccountingDenialReason?: string;\r\n    GLCode?: string; // Assigned by Accounting\r\n\r\n    SubmittedDate?: string;\r\n    Modified?: string;\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\models\\IUser.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\services\\GraphService.ts","messages":[{"ruleId":"@rushstack/no-new-null","severity":1,"message":"Usage of \"null\" is deprecated except when describing legacy APIs; use \"undefined\" instead","line":21,"column":50,"nodeType":"TSNullKeyword","messageId":"error-new-usage-of-null","endLine":21,"endColumn":54},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":67,"column":69,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":72,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2369,2372],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2369,2372],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { WebPartContext } from '@microsoft/sp-webpart-base';\r\nimport { MSGraphClientV3 } from '@microsoft/sp-http';\r\nimport { IUser } from '../models/IUser';\r\n\r\nexport class GraphService {\r\n    private context: WebPartContext;\r\n    private isLocal: boolean;\r\n    private managerCache: IUser | null = null;\r\n    private directReportsCache: IUser[] | null = null;\r\n\r\n    constructor(context: WebPartContext, isLocal: boolean = false) {\r\n        this.context = context;\r\n        this.isLocal = isLocal;\r\n    }\r\n\r\n    private async getClient(): Promise<MSGraphClientV3 | null> {\r\n        if (this.isLocal) return null;\r\n        return await this.context.msGraphClientFactory.getClient('3');\r\n    }\r\n\r\n    public async getMyManager(): Promise<IUser | null> {\r\n        if (this.isLocal) {\r\n            return { displayName: 'Local Manager', email: 'manager@contoso.local' };\r\n        }\r\n\r\n        if (this.managerCache) {\r\n            return this.managerCache;\r\n        }\r\n\r\n        try {\r\n            const client = await this.getClient();\r\n            if (!client) return null;\r\n\r\n            const response = await client.api('/me/manager').select('displayName,mail,id,userPrincipalName').get();\r\n            if (response) {\r\n                this.managerCache = {\r\n                    displayName: response.displayName,\r\n                    email: response.mail || response.userPrincipalName,\r\n                    id: response.id\r\n                };\r\n                return this.managerCache;\r\n            }\r\n        } catch (error) {\r\n            console.warn('Error retrieving manager:', error);\r\n            // Fallback if no manager found or graph api fails\r\n            return null;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    public async getMyDirectReports(): Promise<IUser[]> {\r\n        if (this.isLocal) {\r\n            return [{ displayName: 'Local Report', email: 'report@contoso.local' }];\r\n        }\r\n\r\n        const cache = this.directReportsCache;\r\n        if (cache) {\r\n            return cache;\r\n        }\r\n\r\n        try {\r\n            const client = await this.getClient();\r\n            if (!client) return [];\r\n\r\n            const response = await client.api('/me/directReports').select('displayName,mail,id,userPrincipalName').get();\r\n            if (response && response.value) {\r\n                this.directReportsCache = response.value.map((user: any) => ({\r\n                    displayName: user.displayName,\r\n                    email: user.mail || user.userPrincipalName,\r\n                    id: user.id\r\n                }));\r\n                return this.directReportsCache || [];\r\n            }\r\n        } catch (error) {\r\n            console.warn('Error retrieving direct reports:', error);\r\n            return [];\r\n        }\r\n        return [];\r\n    }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\services\\RoleService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\services\\SharePointService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RequestStatus' is defined but never used.","line":3,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":43}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { WebPartContext } from '@microsoft/sp-webpart-base';\r\nimport { SPHttpClient, SPHttpClientResponse, ISPHttpClientOptions } from '@microsoft/sp-http';\r\nimport { IConferenceRequest, RequestStatus } from '../models/IConferenceRequest';\r\n\r\nexport class SharePointService {\r\n    private context: WebPartContext;\r\n    private listName: string;\r\n\r\n    constructor(context: WebPartContext, listName: string) {\r\n        this.context = context;\r\n        this.listName = listName;\r\n    }\r\n\r\n    private getListUrl(): string {\r\n        return `${this.context.pageContext.web.absoluteUrl}/_api/web/lists/getByTitle('${this.listName}')`;\r\n    }\r\n\r\n    public async getRequests(filter?: string): Promise<IConferenceRequest[]> {\r\n        let url = `${this.getListUrl()}/items?$top=5000`;\r\n        if (filter) {\r\n            url += `&$filter=${filter}`;\r\n        }\r\n\r\n        try {\r\n            const response: SPHttpClientResponse = await this.context.spHttpClient.get(url, SPHttpClient.configurations.v1);\r\n            if (response.ok) {\r\n                const json = await response.json();\r\n                return json.value as IConferenceRequest[];\r\n            }\r\n            throw new Error(await response.text());\r\n        } catch (error) {\r\n            console.error('Error fetching requests', error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    public async getRequestById(id: number): Promise<IConferenceRequest> {\r\n        const url = `${this.getListUrl()}/items(${id})`;\r\n        try {\r\n            const response: SPHttpClientResponse = await this.context.spHttpClient.get(url, SPHttpClient.configurations.v1);\r\n            if (response.ok) {\r\n                return await response.json() as IConferenceRequest;\r\n            }\r\n            throw new Error(await response.text());\r\n        } catch (error) {\r\n            console.error(`Error fetching request ${id}`, error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    public async createRequest(request: Partial<IConferenceRequest>): Promise<IConferenceRequest> {\r\n        const url = `${this.getListUrl()}/items`;\r\n\r\n        // Auto-calculate TotalEstimatedBudget if not provided or to ensure accuracy\r\n        request.TotalEstimatedBudget = this.calculateTotal(request);\r\n\r\n        const options: ISPHttpClientOptions = {\r\n            body: JSON.stringify(request)\r\n        };\r\n\r\n        try {\r\n            const response: SPHttpClientResponse = await this.context.spHttpClient.post(url, SPHttpClient.configurations.v1, options);\r\n            if (response.ok) {\r\n                return await response.json() as IConferenceRequest;\r\n            }\r\n            throw new Error(await response.text());\r\n        } catch (error) {\r\n            console.error('Error creating request', error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    public async updateRequest(id: number, request: Partial<IConferenceRequest>): Promise<void> {\r\n        const url = `${this.getListUrl()}/items(${id})`;\r\n\r\n        if (request.RegistrationCost !== undefined) {\r\n            // if costs are being updated, recalculate total\r\n            request.TotalEstimatedBudget = this.calculateTotal(request);\r\n        }\r\n\r\n        const options: ISPHttpClientOptions = {\r\n            headers: {\r\n                'IF-MATCH': '*',\r\n                'X-HTTP-Method': 'MERGE'\r\n            },\r\n            body: JSON.stringify(request)\r\n        };\r\n\r\n        try {\r\n            const response: SPHttpClientResponse = await this.context.spHttpClient.post(url, SPHttpClient.configurations.v1, options);\r\n            if (!response.ok) {\r\n                throw new Error(await response.text());\r\n            }\r\n        } catch (error) {\r\n            console.error(`Error updating request ${id}`, error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    private calculateTotal(req: Partial<IConferenceRequest>): number {\r\n        return (req.RegistrationCost || 0) +\r\n            (req.AirfareCost || 0) +\r\n            (req.LodgingCost || 0) +\r\n            (req.MeetingRoomRentalCost || 0) +\r\n            (req.CarRentalCost || 0) +\r\n            (req.TravelMealAllowanceCost || 0) +\r\n            (req.ConferenceMealsCost || 0) +\r\n            (req.OtherCost || 0);\r\n    }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\webparts\\nonBudgetedConferenceForm\\NonBudgetedConferenceFormWebPart.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\webparts\\nonBudgetedConferenceForm\\components\\AccountingInterface\\AccountingInterface.tsx","messages":[{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":65,"column":35,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":65,"endColumn":37},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":79,"column":9,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":79,"endColumn":24,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[2192,2192],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[2192,2192],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":82,"column":36,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":82,"endColumn":38},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":93,"column":13,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":93,"endColumn":28,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[2737,2737],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[2737,2737],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":99,"column":33,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":99,"endColumn":35},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":110,"column":13,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":110,"endColumn":28,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[3384,3384],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[3384,3384],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":116,"column":57,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":116,"endColumn":59},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":122,"column":54,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":122,"endColumn":56}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\r\nimport { useState, useEffect } from 'react';\r\nimport {\r\n    makeStyles,\r\n    Card,\r\n    CardHeader,\r\n    Text,\r\n    Button,\r\n    Dialog,\r\n    DialogSurface,\r\n    DialogTitle,\r\n    DialogBody,\r\n    DialogActions,\r\n    DialogContent,\r\n    Textarea,\r\n    Input,\r\n    Label,\r\n    Spinner,\r\n    shorthands,\r\n    tokens\r\n} from '@fluentui/react-components';\r\nimport { IConferenceRequest } from '../../../../models/IConferenceRequest';\r\nimport { useAppContext } from '../../../../context/AppContext';\r\nimport { StatusBadge } from '../Shared/StatusBadge';\r\n\r\nconst useStyles = makeStyles({\r\n    root: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        gap: '16px'\r\n    },\r\n    card: {\r\n        ...shorthands.margin('0px'),\r\n        width: '100%'\r\n    },\r\n    actions: {\r\n        display: 'flex',\r\n        gap: '8px',\r\n        marginTop: '16px',\r\n        borderTop: `1px solid ${tokens.colorNeutralStroke1}`,\r\n        paddingTop: '16px'\r\n    },\r\n    dialogContent: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        gap: '16px'\r\n    }\r\n});\r\n\r\nexport const AccountingInterface: React.FC = () => {\r\n    const styles = useStyles();\r\n    const { spService, currentUser } = useAppContext();\r\n\r\n    const [requests, setRequests] = useState<IConferenceRequest[]>([]);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const [selectedRequest, setSelectedRequest] = useState<IConferenceRequest | null>(null);\r\n\r\n    const [denialReason, setDenialReason] = useState('');\r\n    const [isDenialDialogOpen, setIsDenialDialogOpen] = useState(false);\r\n\r\n    const [glCode, setGlCode] = useState('');\r\n    const [isApprovalDialogOpen, setIsApprovalDialogOpen] = useState(false);\r\n\r\n    const loadRequests = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const filter = `Status eq 'Pending Accounting Approval'`;\r\n            const result = await spService.getRequests(filter);\r\n            setRequests(result);\r\n        } catch (error) {\r\n            console.error('Error loading accounting queue:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        loadRequests();\r\n    }, []);\r\n\r\n    const handleApprove = async () => {\r\n        if (!selectedRequest || !selectedRequest.Id || !glCode.trim()) return;\r\n        try {\r\n            await spService.updateRequest(selectedRequest.Id, {\r\n                Status: 'Fully Approved',\r\n                AccountingApproverEmail: currentUser.email,\r\n                AccountingApprovalDate: new Date().toISOString(),\r\n                GLCode: glCode.trim()\r\n            });\r\n            setIsApprovalDialogOpen(false);\r\n            setGlCode('');\r\n            loadRequests();\r\n        } catch (error) {\r\n            console.error('Error approving request', error);\r\n        }\r\n    };\r\n\r\n    const handleDeny = async () => {\r\n        if (!selectedRequest || !selectedRequest.Id || !denialReason) return;\r\n        try {\r\n            await spService.updateRequest(selectedRequest.Id, {\r\n                Status: 'Denied',\r\n                AccountingDenialReason: denialReason,\r\n                AccountingApproverEmail: currentUser.email,\r\n                AccountingApprovalDate: new Date().toISOString()\r\n            });\r\n            setIsDenialDialogOpen(false);\r\n            setDenialReason('');\r\n            loadRequests();\r\n        } catch (error) {\r\n            console.error('Error denying request', error);\r\n        }\r\n    };\r\n\r\n    const openApproveDialog = (req: IConferenceRequest) => {\r\n        setSelectedRequest(req);\r\n        setGlCode('');\r\n        setIsApprovalDialogOpen(true);\r\n    };\r\n\r\n    const openDenyDialog = (req: IConferenceRequest) => {\r\n        setSelectedRequest(req);\r\n        setDenialReason('');\r\n        setIsDenialDialogOpen(true);\r\n    };\r\n\r\n    return (\r\n        <div className={styles.root}>\r\n            <Text size={500} weight=\"semibold\">Accounting Final Review Queue</Text>\r\n\r\n            {loading && <Spinner label=\"Loading pending requests...\" />}\r\n\r\n            {!loading && requests.length === 0 && (\r\n                <Text>There are no requests pending Accounting approval.</Text>\r\n            )}\r\n\r\n            {requests.map(req => (\r\n                <Card key={req.Id} className={styles.card}>\r\n                    <CardHeader\r\n                        header={\r\n                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n                                <Text weight=\"semibold\">{req.EventName}</Text>\r\n                                <StatusBadge status={req.Status} />\r\n                            </div>\r\n                        }\r\n                        description={<Text>Submitted by: {req.SubmitterName} | Org Dev Approver: {req.OrgDevApproverEmail}</Text>}\r\n                    />\r\n                    <div style={{ padding: '0 12px 12px 12px' }}>\r\n                        <Text block><strong>Location:</strong> {req.EventLocation}</Text>\r\n                        <Text block><strong>Dates:</strong> {new Date(req.EventStartDate || '').toLocaleDateString()} - {new Date(req.EventEndDate || '').toLocaleDateString()}</Text>\r\n                        <Text block><strong>Total Est. Budget:</strong> ${req.TotalEstimatedBudget?.toFixed(2) || '0.00'}</Text>\r\n                        <Text block><strong>Attendees:</strong> {req.Attendees}</Text>\r\n\r\n                        <div className={styles.actions}>\r\n                            <Button appearance=\"primary\" onClick={() => openApproveDialog(req)}>Approve & Assign GL</Button>\r\n                            <Button appearance=\"secondary\" onClick={() => openDenyDialog(req)}>Deny</Button>\r\n                        </div>\r\n                    </div>\r\n                </Card>\r\n            ))}\r\n\r\n            {/* Approve Dialog */}\r\n            <Dialog open={isApprovalDialogOpen} onOpenChange={(e, data) => setIsApprovalDialogOpen(data.open)}>\r\n                <DialogSurface>\r\n                    <DialogBody>\r\n                        <DialogTitle>Final Approval</DialogTitle>\r\n                        <DialogContent className={styles.dialogContent}>\r\n                            <Text>Assign a GL Code / Misc. Event Code for this request to complete final approval.</Text>\r\n                            <div>\r\n                                <Label required>GL Code</Label>\r\n                                <Input\r\n                                    value={glCode}\r\n                                    onChange={(e) => setGlCode(e.target.value)}\r\n                                    placeholder=\"e.g. 1234-567-890\"\r\n                                    style={{ width: '100%' }}\r\n                                />\r\n                            </div>\r\n                        </DialogContent>\r\n                        <DialogActions>\r\n                            <Button appearance=\"secondary\" onClick={() => setIsApprovalDialogOpen(false)}>Cancel</Button>\r\n                            <Button appearance=\"primary\" disabled={!glCode.trim()} onClick={handleApprove}>Approve Request</Button>\r\n                        </DialogActions>\r\n                    </DialogBody>\r\n                </DialogSurface>\r\n            </Dialog>\r\n\r\n            {/* Deny Dialog */}\r\n            <Dialog open={isDenialDialogOpen} onOpenChange={(e, data) => setIsDenialDialogOpen(data.open)}>\r\n                <DialogSurface>\r\n                    <DialogBody>\r\n                        <DialogTitle>Deny Request</DialogTitle>\r\n                        <DialogContent className={styles.dialogContent}>\r\n                            <Text>Please provide a reason for denying this request. This will be visible to the submitter.</Text>\r\n                            <Textarea\r\n                                value={denialReason}\r\n                                onChange={(e) => setDenialReason(e.target.value)}\r\n                                placeholder=\"Reason for denial...\"\r\n                            />\r\n                        </DialogContent>\r\n                        <DialogActions>\r\n                            <Button appearance=\"secondary\" onClick={() => setIsDenialDialogOpen(false)}>Cancel</Button>\r\n                            <Button appearance=\"primary\" disabled={!denialReason} onClick={handleDeny}>Confirm Denial</Button>\r\n                        </DialogActions>\r\n                    </DialogBody>\r\n                </DialogSurface>\r\n            </Dialog>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\webparts\\nonBudgetedConferenceForm\\components\\Header\\Header.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ViewType' is defined but never used.","line":10,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":33}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\r\nimport {\r\n    makeStyles,\r\n    shorthands,\r\n    tokens,\r\n    Button,\r\n    Title3,\r\n    Avatar\r\n} from '@fluentui/react-components';\r\nimport { useAppContext, ViewType } from '../../../../context/AppContext';\r\n\r\nconst useStyles = makeStyles({\r\n    root: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'space-between',\r\n        backgroundColor: tokens.colorNeutralBackground3,\r\n        ...shorthands.padding('16px', '24px'),\r\n        ...shorthands.borderRadius('8px'),\r\n        marginBottom: '24px',\r\n        boxShadow: tokens.shadow4,\r\n    },\r\n    navGroup: {\r\n        display: 'flex',\r\n        gap: '8px',\r\n    },\r\n    userGroup: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        gap: '12px',\r\n    }\r\n});\r\n\r\nexport const Header: React.FC = () => {\r\n    const styles = useStyles();\r\n    const { currentUser, roles, navigation } = useAppContext();\r\n    const { currentView, setCurrentView } = navigation;\r\n\r\n    return (\r\n        <div className={styles.root}>\r\n            <Title3>Non-Budgeted Conference & Event Request</Title3>\r\n\r\n            <div className={styles.navGroup}>\r\n                <Button\r\n                    appearance={currentView === 'User' ? 'primary' : 'subtle'}\r\n                    onClick={() => setCurrentView('User')}\r\n                >\r\n                    My Requests / New Request\r\n                </Button>\r\n\r\n                {roles.isManager && (\r\n                    <Button\r\n                        appearance={currentView === 'Manager' ? 'primary' : 'subtle'}\r\n                        onClick={() => setCurrentView('Manager')}\r\n                    >\r\n                        Manager Queue\r\n                    </Button>\r\n                )}\r\n\r\n                {roles.isOrgDev && (\r\n                    <Button\r\n                        appearance={currentView === 'OrgDev' ? 'primary' : 'subtle'}\r\n                        onClick={() => setCurrentView('OrgDev')}\r\n                    >\r\n                        Org Dev Review\r\n                    </Button>\r\n                )}\r\n\r\n                {roles.isAccounting && (\r\n                    <Button\r\n                        appearance={currentView === 'Accounting' ? 'primary' : 'subtle'}\r\n                        onClick={() => setCurrentView('Accounting')}\r\n                    >\r\n                        Accounting Review\r\n                    </Button>\r\n                )}\r\n            </div>\r\n\r\n            <div className={styles.userGroup}>\r\n                <Avatar name={currentUser.displayName} />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\webparts\\nonBudgetedConferenceForm\\components\\INonBudgetedConferenceFormProps.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\webparts\\nonBudgetedConferenceForm\\components\\ManagerInterface\\ManagerInterface.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogTrigger' is defined but never used.","line":10,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":18},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":61,"column":35,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":61,"endColumn":37},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":76,"column":9,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":76,"endColumn":24,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[2246,2246],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[2246,2246],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":79,"column":36,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":79,"endColumn":38},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":87,"column":13,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":87,"endColumn":28,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[2668,2668],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[2668,2668],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":93,"column":33,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":93,"endColumn":35},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":103,"column":13,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":103,"endColumn":28,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[3248,3248],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[3248,3248],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":109,"column":57,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":109,"endColumn":59},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":114,"column":54,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":114,"endColumn":56}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\r\nimport { useState, useEffect } from 'react';\r\nimport {\r\n    makeStyles,\r\n    Card,\r\n    CardHeader,\r\n    Text,\r\n    Button,\r\n    Dialog,\r\n    DialogTrigger,\r\n    DialogSurface,\r\n    DialogTitle,\r\n    DialogBody,\r\n    DialogActions,\r\n    DialogContent,\r\n    Textarea,\r\n    Spinner,\r\n    shorthands,\r\n    tokens\r\n} from '@fluentui/react-components';\r\nimport { IConferenceRequest } from '../../../../models/IConferenceRequest';\r\nimport { useAppContext } from '../../../../context/AppContext';\r\nimport { StatusBadge } from '../Shared/StatusBadge';\r\n\r\nconst useStyles = makeStyles({\r\n    root: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        gap: '16px'\r\n    },\r\n    card: {\r\n        ...shorthands.margin('0px'),\r\n        width: '100%'\r\n    },\r\n    actions: {\r\n        display: 'flex',\r\n        gap: '8px',\r\n        marginTop: '16px',\r\n        borderTop: `1px solid ${tokens.colorNeutralStroke1}`,\r\n        paddingTop: '16px'\r\n    },\r\n    dialogContent: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        gap: '16px'\r\n    }\r\n});\r\n\r\nexport const ManagerInterface: React.FC = () => {\r\n    const styles = useStyles();\r\n    const { spService, currentUser } = useAppContext();\r\n\r\n    const [requests, setRequests] = useState<IConferenceRequest[]>([]);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const [selectedRequest, setSelectedRequest] = useState<IConferenceRequest | null>(null);\r\n    const [denialReason, setDenialReason] = useState('');\r\n    const [isDenialDialogOpen, setIsDenialDialogOpen] = useState(false);\r\n    const [isApprovalDialogOpen, setIsApprovalDialogOpen] = useState(false);\r\n\r\n    const loadRequests = async () => {\r\n        setLoading(true);\r\n        try {\r\n            // Filter by requests where ManagerEmail matches current user\r\n            const filter = `ManagerEmail eq '${currentUser.email}' and Status eq 'Pending Manager Approval'`;\r\n            const result = await spService.getRequests(filter);\r\n            setRequests(result);\r\n        } catch (error) {\r\n            console.error('Error loading manager queue:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        loadRequests();\r\n    }, [currentUser.email]);\r\n\r\n    const handleApprove = async () => {\r\n        if (!selectedRequest || !selectedRequest.Id) return;\r\n        try {\r\n            await spService.updateRequest(selectedRequest.Id, {\r\n                Status: 'Pending Org Dev Approval',\r\n                ManagerApprovalDate: new Date().toISOString()\r\n            });\r\n            setIsApprovalDialogOpen(false);\r\n            loadRequests();\r\n        } catch (error) {\r\n            console.error('Error approving request', error);\r\n        }\r\n    };\r\n\r\n    const handleDeny = async () => {\r\n        if (!selectedRequest || !selectedRequest.Id || !denialReason) return;\r\n        try {\r\n            await spService.updateRequest(selectedRequest.Id, {\r\n                Status: 'Denied',\r\n                ManagerDenialReason: denialReason,\r\n                ManagerApprovalDate: new Date().toISOString()\r\n            });\r\n            setIsDenialDialogOpen(false);\r\n            setDenialReason('');\r\n            loadRequests();\r\n        } catch (error) {\r\n            console.error('Error denying request', error);\r\n        }\r\n    };\r\n\r\n    const openApproveDialog = (req: IConferenceRequest) => {\r\n        setSelectedRequest(req);\r\n        setIsApprovalDialogOpen(true);\r\n    };\r\n\r\n    const openDenyDialog = (req: IConferenceRequest) => {\r\n        setSelectedRequest(req);\r\n        setDenialReason('');\r\n        setIsDenialDialogOpen(true);\r\n    };\r\n\r\n    return (\r\n        <div className={styles.root}>\r\n            <Text size={500} weight=\"semibold\">Manager Approval Queue</Text>\r\n\r\n            {loading && <Spinner label=\"Loading pending requests...\" />}\r\n\r\n            {!loading && requests.length === 0 && (\r\n                <Text>You have no pending requests to review.</Text>\r\n            )}\r\n\r\n            {requests.map(req => (\r\n                <Card key={req.Id} className={styles.card}>\r\n                    <CardHeader\r\n                        header={\r\n                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n                                <Text weight=\"semibold\">{req.EventName}</Text>\r\n                                <StatusBadge status={req.Status} />\r\n                            </div>\r\n                        }\r\n                        description={<Text>Submitted by: {req.SubmitterName}</Text>}\r\n                    />\r\n                    <div style={{ padding: '0 12px 12px 12px' }}>\r\n                        <Text block><strong>Location:</strong> {req.EventLocation}</Text>\r\n                        <Text block><strong>Total Est. Budget:</strong> ${req.TotalEstimatedBudget?.toFixed(2) || '0.00'}</Text>\r\n                        <Text block><strong>Attendees:</strong> {req.Attendees}</Text>\r\n\r\n                        <div className={styles.actions}>\r\n                            <Button appearance=\"primary\" onClick={() => openApproveDialog(req)}>Approve</Button>\r\n                            <Button appearance=\"secondary\" onClick={() => openDenyDialog(req)}>Deny</Button>\r\n                        </div>\r\n                    </div>\r\n                </Card>\r\n            ))}\r\n\r\n            {/* Approve Dialog */}\r\n            <Dialog open={isApprovalDialogOpen} onOpenChange={(e, data) => setIsApprovalDialogOpen(data.open)}>\r\n                <DialogSurface>\r\n                    <DialogBody>\r\n                        <DialogTitle>Approve Request</DialogTitle>\r\n                        <DialogContent>\r\n                            <Text>\r\n                                By approving this request, I confirm that this event aligns with departmental goals and that budget implications have been considered.\r\n                            </Text>\r\n                        </DialogContent>\r\n                        <DialogActions>\r\n                            <Button appearance=\"secondary\" onClick={() => setIsApprovalDialogOpen(false)}>Cancel</Button>\r\n                            <Button appearance=\"primary\" onClick={handleApprove}>Approve</Button>\r\n                        </DialogActions>\r\n                    </DialogBody>\r\n                </DialogSurface>\r\n            </Dialog>\r\n\r\n            {/* Deny Dialog */}\r\n            <Dialog open={isDenialDialogOpen} onOpenChange={(e, data) => setIsDenialDialogOpen(data.open)}>\r\n                <DialogSurface>\r\n                    <DialogBody>\r\n                        <DialogTitle>Deny Request</DialogTitle>\r\n                        <DialogContent className={styles.dialogContent}>\r\n                            <Text>Please provide a reason for denying this request.</Text>\r\n                            <Textarea\r\n                                value={denialReason}\r\n                                onChange={(e) => setDenialReason(e.target.value)}\r\n                                placeholder=\"Reason for denial...\"\r\n                            />\r\n                        </DialogContent>\r\n                        <DialogActions>\r\n                            <Button appearance=\"secondary\" onClick={() => setIsDenialDialogOpen(false)}>Cancel</Button>\r\n                            <Button appearance=\"primary\" disabled={!denialReason} onClick={handleDeny}>Confirm Denial</Button>\r\n                        </DialogActions>\r\n                    </DialogBody>\r\n                </DialogSurface>\r\n            </Dialog>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\webparts\\nonBudgetedConferenceForm\\components\\NonBudgetedConferenceForm.tsx","messages":[{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":17,"column":16,"nodeType":"FunctionDeclaration","messageId":"missingReturnType","endLine":17,"endColumn":50},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":58,"column":25,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":58,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\nimport { useState, useMemo, useEffect } from 'react';\nimport { FluentProvider, webLightTheme, Spinner } from '@fluentui/react-components';\nimport { INonBudgetedConferenceFormProps } from './INonBudgetedConferenceFormProps';\nimport { AppContext, ViewType, IAppContext } from '../../../context/AppContext';\nimport { SharePointService } from '../../../services/SharePointService';\nimport { GraphService } from '../../../services/GraphService';\nimport { useCurrentUser } from '../../../hooks/useCurrentUser';\nimport { useManagerCheck } from '../../../hooks/useManagerCheck';\nimport { useRoleAccess } from '../../../hooks/useRoleAccess';\nimport { Header } from './Header/Header';\nimport { UserInterface } from './UserInterface/UserInterface';\nimport { ManagerInterface } from './ManagerInterface/ManagerInterface';\nimport { OrgDevInterface } from './OrgDevInterface/OrgDevInterface';\nimport { AccountingInterface } from './AccountingInterface/AccountingInterface';\n\nexport default function NonBudgetedConferenceForm(props: INonBudgetedConferenceFormProps) {\n  const { context, listName, orgDevApprovers, accountingApprovers } = props;\n\n  const spService = useMemo(() => new SharePointService(context, listName), [context, listName]);\n  const graphService = useMemo(() => new GraphService(context), [context]);\n\n  const currentUser = useCurrentUser(context);\n  const { hasDirectReports, loading: graphLoading } = useManagerCheck(graphService);\n  const { isOrgDev, isAccounting } = useRoleAccess(currentUser.email, orgDevApprovers, accountingApprovers);\n\n  const [currentView, setCurrentView] = useState<ViewType>('User');\n\n  useEffect(() => {\n    if (isAccounting) {\n      setCurrentView('Accounting');\n    } else if (isOrgDev) {\n      setCurrentView('OrgDev');\n    } else {\n      setCurrentView('User');\n    }\n  }, [isAccounting, isOrgDev]);\n\n  const appContextValue: IAppContext = {\n    context,\n    currentUser,\n    spService,\n    graphService,\n    roles: {\n      isManager: hasDirectReports,\n      isOrgDev,\n      isAccounting\n    },\n    navigation: {\n      currentView,\n      setCurrentView\n    },\n    lists: {\n      requestsList: listName\n    }\n  };\n\n  const renderView = () => {\n    switch (currentView) {\n      case 'User':\n        return <UserInterface />;\n      case 'Manager':\n        return hasDirectReports ? <ManagerInterface /> : null;\n      case 'OrgDev':\n        return isOrgDev ? <OrgDevInterface /> : null;\n      case 'Accounting':\n        return isAccounting ? <AccountingInterface /> : null;\n      default:\n        return <UserInterface />;\n    }\n  };\n\n  return (\n    <FluentProvider theme={webLightTheme}>\n      <AppContext.Provider value={appContextValue}>\n        {graphLoading ? (\n          <Spinner label=\"Loading application...\" />\n        ) : (\n          <div>\n            <Header />\n            {renderView()}\n          </div>\n        )}\n      </AppContext.Provider>\n    </FluentProvider>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\webparts\\nonBudgetedConferenceForm\\components\\OrgDevInterface\\OrgDevInterface.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogTrigger' is defined but never used.","line":10,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":18},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":60,"column":35,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":60,"endColumn":37},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":74,"column":9,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":74,"endColumn":24,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[2049,2049],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[2049,2049],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":77,"column":59,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":77,"endColumn":61},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":85,"column":13,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":85,"endColumn":28,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[2455,2455],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[2455,2455],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":91,"column":33,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":91,"endColumn":35},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":102,"column":13,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":102,"endColumn":28,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[3090,3090],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[3090,3090],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":108,"column":54,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":108,"endColumn":56}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\r\nimport { useState, useEffect } from 'react';\r\nimport {\r\n    makeStyles,\r\n    Card,\r\n    CardHeader,\r\n    Text,\r\n    Button,\r\n    Dialog,\r\n    DialogTrigger,\r\n    DialogSurface,\r\n    DialogTitle,\r\n    DialogBody,\r\n    DialogActions,\r\n    DialogContent,\r\n    Textarea,\r\n    Spinner,\r\n    shorthands,\r\n    tokens\r\n} from '@fluentui/react-components';\r\nimport { IConferenceRequest } from '../../../../models/IConferenceRequest';\r\nimport { useAppContext } from '../../../../context/AppContext';\r\nimport { StatusBadge } from '../Shared/StatusBadge';\r\n\r\nconst useStyles = makeStyles({\r\n    root: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        gap: '16px'\r\n    },\r\n    card: {\r\n        ...shorthands.margin('0px'),\r\n        width: '100%'\r\n    },\r\n    actions: {\r\n        display: 'flex',\r\n        gap: '8px',\r\n        marginTop: '16px',\r\n        borderTop: `1px solid ${tokens.colorNeutralStroke1}`,\r\n        paddingTop: '16px'\r\n    },\r\n    dialogContent: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        gap: '16px'\r\n    }\r\n});\r\n\r\nexport const OrgDevInterface: React.FC = () => {\r\n    const styles = useStyles();\r\n    const { spService, currentUser } = useAppContext();\r\n\r\n    const [requests, setRequests] = useState<IConferenceRequest[]>([]);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const [selectedRequest, setSelectedRequest] = useState<IConferenceRequest | null>(null);\r\n    const [denialReason, setDenialReason] = useState('');\r\n    const [isDenialDialogOpen, setIsDenialDialogOpen] = useState(false);\r\n\r\n    const loadRequests = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const filter = `Status eq 'Pending Org Dev Approval'`;\r\n            const result = await spService.getRequests(filter);\r\n            setRequests(result);\r\n        } catch (error) {\r\n            console.error('Error loading org dev queue:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        loadRequests();\r\n    }, []);\r\n\r\n    const handleApprove = async (req: IConferenceRequest) => {\r\n        if (!req || !req.Id) return;\r\n        try {\r\n            await spService.updateRequest(req.Id, {\r\n                Status: 'Pending Accounting Approval',\r\n                OrgDevApproverEmail: currentUser.email,\r\n                OrgDevApprovalDate: new Date().toISOString()\r\n            });\r\n            loadRequests();\r\n        } catch (error) {\r\n            console.error('Error approving request', error);\r\n        }\r\n    };\r\n\r\n    const handleDeny = async () => {\r\n        if (!selectedRequest || !selectedRequest.Id || !denialReason) return;\r\n        try {\r\n            await spService.updateRequest(selectedRequest.Id, {\r\n                Status: 'Denied',\r\n                OrgDevDenialReason: denialReason,\r\n                OrgDevApproverEmail: currentUser.email,\r\n                OrgDevApprovalDate: new Date().toISOString()\r\n            });\r\n            setIsDenialDialogOpen(false);\r\n            setDenialReason('');\r\n            loadRequests();\r\n        } catch (error) {\r\n            console.error('Error denying request', error);\r\n        }\r\n    };\r\n\r\n    const openDenyDialog = (req: IConferenceRequest) => {\r\n        setSelectedRequest(req);\r\n        setDenialReason('');\r\n        setIsDenialDialogOpen(true);\r\n    };\r\n\r\n    return (\r\n        <div className={styles.root}>\r\n            <Text size={500} weight=\"semibold\">Organization Development Review Queue</Text>\r\n\r\n            {loading && <Spinner label=\"Loading pending requests...\" />}\r\n\r\n            {!loading && requests.length === 0 && (\r\n                <Text>There are no requests pending Org Dev approval.</Text>\r\n            )}\r\n\r\n            {requests.map(req => (\r\n                <Card key={req.Id} className={styles.card}>\r\n                    <CardHeader\r\n                        header={\r\n                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n                                <Text weight=\"semibold\">{req.EventName}</Text>\r\n                                <StatusBadge status={req.Status} />\r\n                            </div>\r\n                        }\r\n                        description={<Text>Submitted by: {req.SubmitterName} | Manager: {req.ManagerEmail}</Text>}\r\n                    />\r\n                    <div style={{ padding: '0 12px 12px 12px' }}>\r\n                        <Text block><strong>Location:</strong> {req.EventLocation}</Text>\r\n                        <Text block><strong>Dates:</strong> {new Date(req.EventStartDate || '').toLocaleDateString()} - {new Date(req.EventEndDate || '').toLocaleDateString()}</Text>\r\n                        <Text block><strong>Total Est. Budget:</strong> ${req.TotalEstimatedBudget?.toFixed(2) || '0.00'}</Text>\r\n                        <Text block><strong>Attendees:</strong> {req.Attendees}</Text>\r\n                        <Text block><strong>Primary Objective:</strong> {req.PrimaryObjective}</Text>\r\n\r\n                        <div className={styles.actions}>\r\n                            <Button appearance=\"primary\" onClick={() => handleApprove(req)}>Approve</Button>\r\n                            <Button appearance=\"secondary\" onClick={() => openDenyDialog(req)}>Deny</Button>\r\n                        </div>\r\n                    </div>\r\n                </Card>\r\n            ))}\r\n\r\n            {/* Deny Dialog */}\r\n            <Dialog open={isDenialDialogOpen} onOpenChange={(e, data) => setIsDenialDialogOpen(data.open)}>\r\n                <DialogSurface>\r\n                    <DialogBody>\r\n                        <DialogTitle>Deny Request</DialogTitle>\r\n                        <DialogContent className={styles.dialogContent}>\r\n                            <Text>Please provide a reason for denying this request. This will be visible to the submitter.</Text>\r\n                            <Textarea\r\n                                value={denialReason}\r\n                                onChange={(e) => setDenialReason(e.target.value)}\r\n                                placeholder=\"Reason for denial...\"\r\n                            />\r\n                        </DialogContent>\r\n                        <DialogActions>\r\n                            <Button appearance=\"secondary\" onClick={() => setIsDenialDialogOpen(false)}>Cancel</Button>\r\n                            <Button appearance=\"primary\" disabled={!denialReason} onClick={handleDeny}>Confirm Denial</Button>\r\n                        </DialogActions>\r\n                    </DialogBody>\r\n                </DialogSurface>\r\n            </Dialog>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\webparts\\nonBudgetedConferenceForm\\components\\Shared\\StatusBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\webparts\\nonBudgetedConferenceForm\\components\\UserInterface\\MyRequestsQueue.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":47,"column":28,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[1165,1204],"text":"You haven&apos;t submitted any requests yet."},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[1165,1204],"text":"You haven&lsquo;t submitted any requests yet."},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[1165,1204],"text":"You haven&#39;t submitted any requests yet."},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[1165,1204],"text":"You haven&rsquo;t submitted any requests yet."},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\r\nimport {\r\n    makeStyles,\r\n    Card,\r\n    CardHeader,\r\n    Text,\r\n    tokens,\r\n    shorthands\r\n} from '@fluentui/react-components';\r\nimport { IConferenceRequest } from '../../../../models/IConferenceRequest';\r\nimport { StatusBadge } from '../Shared/StatusBadge';\r\n\r\nconst useStyles = makeStyles({\r\n    queueList: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        gap: '12px'\r\n    },\r\n    card: {\r\n        ...shorthands.margin('0px'),\r\n        width: '100%',\r\n        maxWidth: '100%'\r\n    },\r\n    row: {\r\n        display: 'flex',\r\n        justifyContent: 'space-between',\r\n        alignItems: 'center',\r\n        marginBottom: '8px'\r\n    },\r\n    denialReason: {\r\n        color: tokens.colorPaletteRedForeground1,\r\n        marginTop: '8px',\r\n        paddingTop: '8px',\r\n        borderTop: `1px solid ${tokens.colorNeutralStroke1}`\r\n    }\r\n});\r\n\r\ninterface IMyRequestsQueueProps {\r\n    requests: IConferenceRequest[];\r\n}\r\n\r\nexport const MyRequestsQueue: React.FC<IMyRequestsQueueProps> = ({ requests }) => {\r\n    const styles = useStyles();\r\n\r\n    if (requests.length === 0) {\r\n        return (\r\n            <Text>You haven't submitted any requests yet.</Text>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className={styles.queueList}>\r\n            {requests.map(req => (\r\n                <Card key={req.Id} className={styles.card}>\r\n                    <CardHeader\r\n                        header={\r\n                            <div className={styles.row}>\r\n                                <Text weight=\"semibold\" size={400}>{req.EventName}</Text>\r\n                                <StatusBadge status={req.Status} />\r\n                            </div>\r\n                        }\r\n                        description={\r\n                            <Text size={300}>\r\n                                {new Date(req.EventStartDate || '').toLocaleDateString()} - {new Date(req.EventEndDate || '').toLocaleDateString()}\r\n                            </Text>\r\n                        }\r\n                    />\r\n\r\n                    <div style={{ padding: '0 12px 12px 12px' }}>\r\n                        <Text block><strong>Location:</strong> {req.EventLocation}</Text>\r\n                        <Text block><strong>Total Est. Budget:</strong> ${req.TotalEstimatedBudget?.toFixed(2) || '0.00'}</Text>\r\n\r\n                        {req.Status === 'Denied' && req.ManagerDenialReason && (\r\n                            <div className={styles.denialReason}>\r\n                                <Text><strong>Reason for Denial (Manager):</strong> {req.ManagerDenialReason}</Text>\r\n                            </div>\r\n                        )}\r\n                        {req.Status === 'Denied' && req.OrgDevDenialReason && (\r\n                            <div className={styles.denialReason}>\r\n                                <Text><strong>Reason for Denial (Org Dev):</strong> {req.OrgDevDenialReason}</Text>\r\n                            </div>\r\n                        )}\r\n                        {req.Status === 'Denied' && req.AccountingDenialReason && (\r\n                            <div className={styles.denialReason}>\r\n                                <Text><strong>Reason for Denial (Accounting):</strong> {req.AccountingDenialReason}</Text>\r\n                            </div>\r\n                        )}\r\n\r\n                        {req.GLCode && (\r\n                            <Text block style={{ marginTop: 8, color: tokens.colorPaletteGreenForeground1 }}>\r\n                                <strong>Assigned GL Code:</strong> {req.GLCode}\r\n                            </Text>\r\n                        )}\r\n                    </div>\r\n                </Card>\r\n            ))}\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\webparts\\nonBudgetedConferenceForm\\components\\UserInterface\\RequestForm.tsx","messages":[{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":105,"column":94,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":105,"endColumn":96},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":110,"column":71,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":110,"endColumn":73},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":116,"column":71,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":116,"endColumn":73},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":124,"column":31,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":124,"endColumn":33},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":149,"column":77,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":149,"endColumn":79}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\r\nimport { useState } from 'react';\r\nimport {\r\n    makeStyles,\r\n    Button,\r\n    Input,\r\n    Textarea,\r\n    Checkbox,\r\n    Label,\r\n    Text,\r\n    Spinner,\r\n    shorthands,\r\n    tokens\r\n} from '@fluentui/react-components';\r\nimport { IConferenceRequest } from '../../../../models/IConferenceRequest';\r\nimport { CORPORATE_PRIORITIES } from '../../../../constants';\r\nimport { useAppContext } from '../../../../context/AppContext';\r\n\r\nconst useStyles = makeStyles({\r\n    formContainer: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        gap: '24px',\r\n        backgroundColor: tokens.colorNeutralBackground1,\r\n        ...shorthands.padding('24px'),\r\n        ...shorthands.borderRadius('8px'),\r\n        boxShadow: tokens.shadow2\r\n    },\r\n    section: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        gap: '16px',\r\n        paddingBottom: '24px',\r\n        borderBottom: `1px solid ${tokens.colorNeutralStroke1}`\r\n    },\r\n    row: {\r\n        display: 'grid',\r\n        gridTemplateColumns: '1fr 1fr',\r\n        gap: '16px',\r\n        '@media (max-width: 600px)': {\r\n            gridTemplateColumns: '1fr'\r\n        }\r\n    },\r\n    fieldGroup: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        gap: '4px'\r\n    },\r\n    errorText: {\r\n        color: tokens.colorPaletteRedForeground1,\r\n        fontSize: '12px'\r\n    },\r\n    totalSection: {\r\n        display: 'flex',\r\n        justifyContent: 'space-between',\r\n        alignItems: 'center',\r\n        backgroundColor: tokens.colorNeutralBackground3,\r\n        ...shorthands.padding('16px'),\r\n        ...shorthands.borderRadius('4px')\r\n    },\r\n    actions: {\r\n        display: 'flex',\r\n        gap: '12px',\r\n        justifyContent: 'flex-end',\r\n        marginTop: '16px'\r\n    }\r\n});\r\n\r\ninterface IRequestFormProps {\r\n    onSubmitSuccess: () => void;\r\n}\r\n\r\nexport const RequestForm: React.FC<IRequestFormProps> = ({ onSubmitSuccess }) => {\r\n    const styles = useStyles();\r\n    const { spService, currentUser, graphService } = useAppContext();\r\n\r\n    const [loading, setLoading] = useState(false);\r\n    const [errorMsg, setErrorMsg] = useState('');\r\n\r\n    const [formData, setFormData] = useState<Partial<IConferenceRequest>>({\r\n        EventName: '',\r\n        EventLocation: '',\r\n        Attendees: '',\r\n        PrimaryObjective: '',\r\n        CorporatePriorities: '[]',\r\n        KnowledgeSharingPlan: '',\r\n        PreviouslyAttended: '',\r\n        HowManyAttended: 1,\r\n        RegistrationCost: 0,\r\n        AirfareCost: 0,\r\n        LodgingCost: 0,\r\n        MeetingRoomRentalCost: 0,\r\n        CarRentalCost: 0,\r\n        TravelMealAllowanceCost: 0,\r\n        ConferenceMealsCost: 0,\r\n        OtherCost: 0,\r\n        AdditionalComments: '',\r\n        Status: 'Draft'\r\n    });\r\n\r\n    const [startDate, setStartDate] = useState<string>('');\r\n    const [endDate, setEndDate] = useState<string>('');\r\n    const [selectedPriorities, setSelectedPriorities] = useState<string[]>([]);\r\n\r\n    const handleInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n        const { name, value } = e.target;\r\n        setFormData(prev => ({ ...prev, [name]: value }));\r\n    };\r\n\r\n    const handleCostChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const { name, value } = e.target;\r\n        const numValue = parseFloat(value) || 0;\r\n        setFormData(prev => ({ ...prev, [name]: numValue }));\r\n    };\r\n\r\n    const handlePriorityChange = (priority: string, checked: boolean) => {\r\n        setSelectedPriorities(prev => {\r\n            const next = checked ? [...prev, priority] : prev.filter(p => p !== priority);\r\n            setFormData(f => ({ ...f, CorporatePriorities: JSON.stringify(next) }));\r\n            return next;\r\n        });\r\n    };\r\n\r\n    const calculateTotal = () => {\r\n        return (\r\n            (formData.RegistrationCost || 0) +\r\n            (formData.AirfareCost || 0) +\r\n            (formData.LodgingCost || 0) +\r\n            (formData.MeetingRoomRentalCost || 0) +\r\n            (formData.CarRentalCost || 0) +\r\n            (formData.TravelMealAllowanceCost || 0) +\r\n            (formData.ConferenceMealsCost || 0) +\r\n            (formData.OtherCost || 0)\r\n        );\r\n    };\r\n\r\n    const validateForm = (): boolean => {\r\n        if (!formData.EventName || !formData.EventLocation || !formData.Attendees ||\r\n            !startDate || !endDate || !formData.PrimaryObjective ||\r\n            selectedPriorities.length === 0 || !formData.KnowledgeSharingPlan ||\r\n            !formData.HowManyAttended) {\r\n            setErrorMsg('Please fill in all required fields.');\r\n            return false;\r\n        }\r\n        setErrorMsg('');\r\n        return true;\r\n    };\r\n\r\n    const submitForm = async (status: 'Draft' | 'Pending Manager Approval') => {\r\n        if (status === 'Pending Manager Approval' && !validateForm()) {\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        setErrorMsg('');\r\n\r\n        try {\r\n            // Get manager info\r\n            const manager = await graphService.getMyManager();\r\n\r\n            const payload: Partial<IConferenceRequest> = {\r\n                ...formData,\r\n                Title: formData.EventName,\r\n                EventStartDate: startDate ? new Date(startDate).toISOString() : null,\r\n                EventEndDate: endDate ? new Date(endDate).toISOString() : null,\r\n                TotalEstimatedBudget: calculateTotal(),\r\n                Status: status,\r\n                SubmitterEmail: currentUser.email,\r\n                SubmitterName: currentUser.displayName,\r\n                ManagerEmail: manager?.email || '',\r\n                SubmittedDate: status === 'Pending Manager Approval' ? new Date().toISOString() : undefined\r\n            };\r\n\r\n            await spService.createRequest(payload);\r\n            onSubmitSuccess();\r\n\r\n        } catch (err) {\r\n            console.error('Submit error:', err);\r\n            setErrorMsg('An error occurred while saving the request.');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={styles.formContainer}>\r\n            {/* SECTION 1: Event Details */}\r\n            <div className={styles.section}>\r\n                <Text weight=\"semibold\" size={500}>1. Event Details</Text>\r\n\r\n                <div className={styles.row}>\r\n                    <div className={styles.fieldGroup}>\r\n                        <Label required>Event Name</Label>\r\n                        <Input name=\"EventName\" value={formData.EventName} onChange={handleInputChange} />\r\n                    </div>\r\n                    <div className={styles.fieldGroup}>\r\n                        <Label required>Location (City & State)</Label>\r\n                        <Input name=\"EventLocation\" value={formData.EventLocation} onChange={handleInputChange} />\r\n                    </div>\r\n                </div>\r\n\r\n                <div className={styles.row}>\r\n                    <div className={styles.fieldGroup}>\r\n                        <Label required>Start Date</Label>\r\n                        <Input type=\"date\" value={startDate} onChange={(e) => setStartDate(e.target.value)} />\r\n                    </div>\r\n                    <div className={styles.fieldGroup}>\r\n                        <Label required>End Date</Label>\r\n                        <Input type=\"date\" value={endDate} onChange={(e) => setEndDate(e.target.value)} />\r\n                    </div>\r\n                </div>\r\n\r\n                <div className={styles.fieldGroup}>\r\n                    <Label required>Names of Attendees (Emails)</Label>\r\n                    <Input name=\"Attendees\" value={formData.Attendees} onChange={handleInputChange} placeholder=\"e.g. john@contoso.com, jane@contoso.com\" />\r\n                </div>\r\n\r\n                <div className={styles.fieldGroup}>\r\n                    <Label required>How many attended?</Label>\r\n                    <Input type=\"number\" name=\"HowManyAttended\" value={formData.HowManyAttended?.toString()} onChange={handleInputChange} />\r\n                </div>\r\n            </div>\r\n\r\n            {/* SECTION 2: Corporate Priorities */}\r\n            <div className={styles.section}>\r\n                <Text weight=\"semibold\" size={500}>2. Corporate Priorities Alignment</Text>\r\n\r\n                <div className={styles.fieldGroup}>\r\n                    <Label required>Primary Objective(s) for Attendance</Label>\r\n                    <Textarea name=\"PrimaryObjective\" value={formData.PrimaryObjective} onChange={handleInputChange} />\r\n                </div>\r\n\r\n                <div className={styles.fieldGroup}>\r\n                    <Label required>Corporate Priorities Supported</Label>\r\n                    {CORPORATE_PRIORITIES.map(priority => (\r\n                        <Checkbox\r\n                            key={priority}\r\n                            label={priority}\r\n                            checked={selectedPriorities.indexOf(priority) > -1}\r\n                            onChange={(e, data) => handlePriorityChange(priority, !!data.checked)}\r\n                        />\r\n                    ))}\r\n                </div>\r\n\r\n                <div className={styles.fieldGroup}>\r\n                    <Label required>Knowledge Sharing Plan</Label>\r\n                    <Textarea name=\"KnowledgeSharingPlan\" value={formData.KnowledgeSharingPlan} onChange={handleInputChange} />\r\n                </div>\r\n\r\n                <div className={styles.fieldGroup}>\r\n                    <Label>Previously Attended? (Year(s) and Employee(s))</Label>\r\n                    <Textarea name=\"PreviouslyAttended\" value={formData.PreviouslyAttended} onChange={handleInputChange} />\r\n                </div>\r\n            </div>\r\n\r\n            {/* SECTION 3: Costs */}\r\n            <div className={styles.section}>\r\n                <Text weight=\"semibold\" size={500}>3. Total Expense / Cost Allocation</Text>\r\n\r\n                <div className={styles.row}>\r\n                    <div className={styles.fieldGroup}>\r\n                        <Label required>Registration Cost</Label>\r\n                        <Input type=\"number\" name=\"RegistrationCost\" value={formData.RegistrationCost?.toString()} onChange={handleCostChange} contentBefore=\"$\" />\r\n                    </div>\r\n                    <div className={styles.fieldGroup}>\r\n                        <Label required>Airfare Cost</Label>\r\n                        <Input type=\"number\" name=\"AirfareCost\" value={formData.AirfareCost?.toString()} onChange={handleCostChange} contentBefore=\"$\" />\r\n                    </div>\r\n                    <div className={styles.fieldGroup}>\r\n                        <Label required>Lodging Cost</Label>\r\n                        <Input type=\"number\" name=\"LodgingCost\" value={formData.LodgingCost?.toString()} onChange={handleCostChange} contentBefore=\"$\" />\r\n                    </div>\r\n                    <div className={styles.fieldGroup}>\r\n                        <Label required>Meeting Room Rental Cost</Label>\r\n                        <Input type=\"number\" name=\"MeetingRoomRentalCost\" value={formData.MeetingRoomRentalCost?.toString()} onChange={handleCostChange} contentBefore=\"$\" />\r\n                    </div>\r\n                    <div className={styles.fieldGroup}>\r\n                        <Label required>Car Rental Cost</Label>\r\n                        <Input type=\"number\" name=\"CarRentalCost\" value={formData.CarRentalCost?.toString()} onChange={handleCostChange} contentBefore=\"$\" />\r\n                    </div>\r\n                    <div className={styles.fieldGroup}>\r\n                        <Label required>Travel Meal Allowance</Label>\r\n                        <Input type=\"number\" name=\"TravelMealAllowanceCost\" value={formData.TravelMealAllowanceCost?.toString()} onChange={handleCostChange} contentBefore=\"$\" />\r\n                    </div>\r\n                    <div className={styles.fieldGroup}>\r\n                        <Label required>Conference Meals Cost</Label>\r\n                        <Input type=\"number\" name=\"ConferenceMealsCost\" value={formData.ConferenceMealsCost?.toString()} onChange={handleCostChange} contentBefore=\"$\" />\r\n                    </div>\r\n                    <div className={styles.fieldGroup}>\r\n                        <Label required>Other Cost</Label>\r\n                        <Input type=\"number\" name=\"OtherCost\" value={formData.OtherCost?.toString()} onChange={handleCostChange} contentBefore=\"$\" />\r\n                    </div>\r\n                </div>\r\n\r\n                <div className={styles.totalSection}>\r\n                    <Text weight=\"bold\" size={400}>TOTAL ESTIMATED BUDGET:</Text>\r\n                    <Text weight=\"bold\" size={500}>${calculateTotal().toFixed(2)}</Text>\r\n                </div>\r\n\r\n                <div className={styles.fieldGroup} style={{ marginTop: '16px' }}>\r\n                    <Label>Additional Comments</Label>\r\n                    <Textarea name=\"AdditionalComments\" value={formData.AdditionalComments} onChange={handleInputChange} />\r\n                </div>\r\n            </div>\r\n\r\n            {errorMsg && <Text className={styles.errorText}>{errorMsg}</Text>}\r\n\r\n            <div className={styles.actions}>\r\n                <Button disabled={loading} onClick={() => submitForm('Draft')}>Save as Draft</Button>\r\n                <Button appearance=\"primary\" disabled={loading} onClick={() => submitForm('Pending Manager Approval')}>\r\n                    {loading ? <Spinner size=\"tiny\" /> : 'Submit for Manager Approval'}\r\n                </Button>\r\n            </div>\r\n\r\n            <Text size={200} style={{ color: tokens.colorNeutralForeground3, textAlign: 'right' }}>\r\n                *By approving or submitting this request, I confirm that this event aligns with departmental goals and that budget implications have been considered.\r\n            </Text>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\SPFXNONBUDGETFORM\\src\\webparts\\nonBudgetedConferenceForm\\components\\UserInterface\\UserInterface.tsx","messages":[{"ruleId":"@typescript-eslint/no-use-before-define","severity":2,"message":"'loadMyRequests' was used before it was defined.","line":34,"column":13,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":34,"endColumn":27},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":34,"column":13,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":34,"endColumn":30,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[1015,1015],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[1015,1015],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":38,"column":37,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":38,"endColumn":39},{"ruleId":"@typescript-eslint/explicit-function-return-type","severity":1,"message":"Missing return type on function.","line":51,"column":74,"nodeType":"ArrowFunctionExpression","messageId":"missingReturnType","endLine":51,"endColumn":76}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\r\nimport { useState, useEffect } from 'react';\r\nimport {\r\n    makeStyles,\r\n    TabList,\r\n    Tab,\r\n    SelectTabData,\r\n    SelectTabEvent,\r\n    Spinner\r\n} from '@fluentui/react-components';\r\nimport { useAppContext } from '../../../../context/AppContext';\r\nimport { RequestForm } from './RequestForm';\r\nimport { MyRequestsQueue } from './MyRequestsQueue';\r\nimport { IConferenceRequest } from '../../../../models/IConferenceRequest';\r\n\r\nconst useStyles = makeStyles({\r\n    root: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        gap: '20px'\r\n    }\r\n});\r\n\r\nexport const UserInterface: React.FC = () => {\r\n    const styles = useStyles();\r\n    const { spService, currentUser } = useAppContext();\r\n\r\n    const [activeTab, setActiveTab] = useState<string>('form');\r\n    const [myRequests, setMyRequests] = useState<IConferenceRequest[]>([]);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (activeTab === 'queue') {\r\n            loadMyRequests();\r\n        }\r\n    }, [activeTab]);\r\n\r\n    const loadMyRequests = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const filter = `SubmitterEmail eq '${currentUser.email}'`;\r\n            const requests = await spService.getRequests(filter);\r\n            setMyRequests(requests);\r\n        } catch (error) {\r\n            console.error('Error loading my requests:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleTabSelect = (event: SelectTabEvent, data: SelectTabData) => {\r\n        setActiveTab(data.value as string);\r\n    };\r\n\r\n    return (\r\n        <div className={styles.root}>\r\n            <TabList selectedValue={activeTab} onTabSelect={handleTabSelect}>\r\n                <Tab value=\"form\">New Request</Tab>\r\n                <Tab value=\"queue\">My Requests</Tab>\r\n            </TabList>\r\n\r\n            {activeTab === 'form' && (\r\n                <RequestForm onSubmitSuccess={() => setActiveTab('queue')} />\r\n            )}\r\n\r\n            {activeTab === 'queue' && (\r\n                loading ? (\r\n                    <Spinner label=\"Loading your requests...\" />\r\n                ) : (\r\n                    <MyRequestsQueue requests={myRequests} />\r\n                )\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-var-requires","replacedBy":["@typescript-eslint/no-require-imports"]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]}]
